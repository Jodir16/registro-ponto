<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Registro de Ponto</title>
<style>
  body { font-family: Arial, sans-serif; max-width: 400px; margin: 30px auto; }
  label { display: block; margin-top: 15px; }
  select, input { width: 100%; padding: 8px; font-size: 16px; margin-top: 5px; }
  button { margin-top: 20px; padding: 10px; width: 100%; font-size: 18px; }
  #msg { margin-top: 20px; font-weight: bold; }
</style>
</head>
<body>

<h2>Registro de Ponto</h2>

<label for="codigo">Código do Funcionário:</label>
<input type="text" id="codigo" maxlength="3" placeholder="Ex: 001" pattern="[0-9]{3}" required />

<label for="tipo">Tipo de Registro:</label>
<select id="tipo" required>
  <option value="">-- Selecione --</option>
  <option value="Entrada">Entrada</option>
  <option value="Inicio Pausa">Início Pausa</option>
  <option value="Fim Pausa">Fim Pausa</option>
  <option value="Saida">Saída</option>
</select>

<p><strong>Data e Hora atual:</strong> <span id="dataHora"></span></p>

<button id="btnRegistrar">Registrar</button>

<div id="msg"></div>

<script>
  const endpoint = "https://script.google.com/macros/s/AKfycbwjWH5ghOXybX0sHJHpqoO0jtQJEOZqrg9FNmai49eNpo9IeuVS0E49MAU_u-HGlRyc/exec";

  function atualizarDataHora() {
    const now = new Date();
    const data = now.toLocaleDateString('pt-BR');
    const hora = now.toLocaleTimeString('pt-BR', {hour12:false});
    document.getElementById('dataHora').textContent = data + " " + hora;
  }

  atualizarDataHora();
  setInterval(atualizarDataHora, 1000);

  document.getElementById('btnRegistrar').addEventListener('click', () => {
    const codigo = document.getElementById('codigo').value.trim();
    const tipo = document.getElementById('tipo').value;

    if (!/^\d{3}$/.test(codigo)) {
      mostrarMensagem("Código inválido. Use 3 dígitos numéricos.", true);
      return;
    }
    if (!tipo) {
      mostrarMensagem("Selecione o tipo de registro.", true);
      return;
    }

    mostrarMensagem("Enviando registro...", false);

    fetch(`${endpoint}?codigo=${encodeURIComponent(codigo)}&tipo=${encodeURIComponent(tipo)}`, {
      method: 'POST',
    })
    .then(response => response.text())
    .then(text => {
      if (text.toLowerCase().includes("erro")) {
        mostrarMensagem("Erro: " + text, true);
      } else {
        mostrarMensagem(text, false);
      }
    })
    .catch(() => {
      mostrarMensagem("Erro ao conectar com o servidor.", true);
    });
  });

  function mostrarMensagem(msg, erro = false) {
    const div = document.getElementById('msg');
    div.textContent = msg;
    div.style.color = erro ? 'red' : 'green';
  }
</script>

</body>
</html>

